{"version":3,"sources":["uni-app:///main.js","webpack:///C:/Users/57697/Desktop/校餐通商户端/pages/printer/sendCommand.vue?78cd","webpack:///C:/Users/57697/Desktop/校餐通商户端/pages/printer/sendCommand.vue?6d9b","webpack:///C:/Users/57697/Desktop/校餐通商户端/pages/printer/sendCommand.vue?10f2","webpack:///C:/Users/57697/Desktop/校餐通商户端/pages/printer/sendCommand.vue?67b8","uni-app:///pages/printer/sendCommand.vue","webpack:///C:/Users/57697/Desktop/校餐通商户端/pages/printer/sendCommand.vue?263c","webpack:///C:/Users/57697/Desktop/校餐通商户端/pages/printer/sendCommand.vue?02d8"],"names":["createPage","Page"],"mappings":";;;;;;;;;;kDAAA;AACA;AACA,0G;AACAA,UAAU,CAACC,oBAAD,CAAV,C;;;;;;;;;;;;;ACHA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAwH;AACxH;AAC+D;AACL;AACc;;;AAGxE;AACoL;AACpL,gBAAgB,6LAAU;AAC1B,EAAE,iFAAM;AACR,EAAE,sFAAM;AACR,EAAE,+FAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,0FAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACRA;AAAA;AAAA;AAAA;AAAgrB,CAAgB,qsBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACmCpsB,gD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAHA,+DACA,+DACA,uE,eAIA,EACA,IADA,kBACA,CACA,SACA,eADA,EAEA,WAFA,EAGA,cAHA,EAIA,WAJA,EAKA,cALA,EAMA,gBANA,EAOA,gBAPA,EAQA,iBARA,EASA,uDATA,EAUA,YAVA,EAWA,YAXA,EAYA,YAZA,EAaA,gBAbA,EAcA,aAdA,EAeA,eAfA,EAgBA,oBAhBA,EAiBA,kBAjBA,EAkBA,QAlBA,GAoBA,CAtBA,EAuBA,uDAvBA,EAwBA,MAxBA,oBAwBA,CACA,gBADA,IAGA,cAHA,GAIA,cAJA,CAGA,cAHA;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GA9CA;AA+CA,SA/CA,qBA+CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GA9DA;AA+DA,QA/DA,oBA+DA;AACA;AACA;AACA;AACA;AACA,wBADA;AAEA,aAFA,mBAEA,GAFA,EAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OATA;;AAWA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GArFA;AAsFA,UAtFA,sBAsFA;AACA,oBADA;;AAGA,kBAHA;AAIA,kBAJA,CAGA,cAHA;AAKA;AACA;AACA;AACA;AACA;AACA;AACA,GAjGA;AAkGA;AACA,WADA,qBACA;AACA;AACA;AACA;AACA,OAHA;AAIA,KANA;AAOA;AACA,cARA,sBAQA,CARA,EAQA;AACA;AACA,KAVA;AAWA;AACA,YAZA,sBAYA;AACA;AACA;AACA;AACA,eADA,EACA;AACA,6CADA,EADA;AAGA,YAHA,CAGA,IAHA;;AAKA;AACA,KArBA;AAsBA;AACA,aAvBA,uBAuBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCADA;AAEA,YAFA;AAGA,YAHA;AAIA,0BAJA;AAKA,4BALA;AAMA;AACA;AACA,SARA;AASA;AACA;AACA;AACA;AACA,SAbA;;AAeA,KAtDA;;AAwDA;AACA,eAzDA,yBAyDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBARA,CAQA;AACA,8BATA,CASA;AACA,wCAVA,CAUA;AACA;AACA;AACA;AACA;;AAEA,sBAhBA,CAgBA;AACA,6BAjBA,CAiBA;AACA;AACA,wCAnBA,CAmBA;AACA;AACA;AACA;AACA,wCAvBA,CAuBA;AACA;AACA,kCAzBA,CAyBA;AACA;AACA,2BA3BA,CA2BA;AACA,sBA5BA,CA4BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBArCA,CAqCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAVA;;;;AAcA;AACA,sBArDA,CAqDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,2BAnEA,CAmEA;AACA,sBApEA,CAoEA;AACA,wCArEA,CAqEA;AACA;AACA;AACA;AACA;;AAEA;AACA,wCA5EA,CA4EA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;;;;;AAMA,KApJA;;AAsJA;AACA,eAvJA,uBAuJA,IAvJA,EAuJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAlKA;AAmKA;AACA,eApKA,yBAoKA;AACA;AACA;AACA,KAvKA;AAwKA;AACA,QAzKA,gBAyKA,IAzKA,EAyKA;AACA,sBADA;AAEA,iBAFA,GAEA,IAFA,CAEA,WAFA,CAEA,QAFA,GAEA,IAFA,CAEA,QAFA,CAEA,QAFA,GAEA,IAFA,CAEA,QAFA,CAEA,UAFA,GAEA,IAFA,CAEA,WAFA,CAEA,QAFA,GAEA,IAFA,CAEA,UAFA,CAEA,YAFA,GAEA,IAFA,CAEA,YAFA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OANA,MAMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oEAlBA;;AAoBA,oBApBA;AAqBA,oBArBA,CAoBA,cApBA;;AAuBA;AACA,yCADA;AAEA,gDAFA;AAGA,wDAHA;AAIA,kBAJA;AAKA;AACA;AACA;AACA,kCADA;AAEA,cAFA,CAEA;AACA;AACA,8BADA;AAEA,6BAFA;;AAIA,WAPA;AAQA,SAfA;AAgBA;AACA;AACA,SAlBA;AAmBA;AACA;AACA;AACA;AACA;AACA,WAHA,MAGA;AACA;AACA,gDADA;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAPA,MAOA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SA1CA;;AA4CA,KA5OA;AA6OA;AACA;AACA;AACA;AACA;AACA,KAlPA;AAmPA;AACA;AACA;AACA;AACA;AACA,KAxPA,EAlGA,E;;;;;;;;;;;;;ACtCA;AAAA;AAAA;AAAA;AAAovC,CAAgB,qtCAAG,EAAC,C;;;;;;;;;;;ACAxwC;AACA,OAAO,KAAU,EAAE,kBAKd","file":"pages/printer/sendCommand.js","sourcesContent":["import 'uni-pages';\nimport Vue from 'vue'\nimport Page from './pages/printer/sendCommand.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./sendCommand.vue?vue&type=template&id=81249376&\"\nvar renderjs\nimport script from \"./sendCommand.vue?vue&type=script&lang=js&\"\nexport * from \"./sendCommand.vue?vue&type=script&lang=js&\"\nimport style0 from \"./sendCommand.vue?vue&type=style&index=0&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\runtime\\\\componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/printer/sendCommand.vue\"\nexport default component.exports","export * from \"-!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\templateLoader.js??vue-loader-options!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--16-0!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\template.js!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-uni-app-loader\\\\page-meta.js!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./sendCommand.vue?vue&type=template&id=81249376&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./sendCommand.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./sendCommand.vue?vue&type=script&lang=js&\"","<template>\r\n\t<view class=\"content\">\r\n\t\t<view class=\"body\">\r\n\t\t\t<view>\r\n\t\t\t\t<textarea class=\"result\" v-model=\"returnResult\"></textarea>\r\n\t\t\t</view>\r\n\t\t\t<textarea class=\"input\" @input=\"inputEvent\" />\r\n\t\t\t<button type=\"primary\" @tap=\"sendData\">发送(票据可使用)</button> \r\n\t\t\r\n\t\t\t<view style='margin-top:4%;display: flex;flex-direction: row;'>\r\n\t\t\t   <button type='primary' @tap='receiptTest' :loading='isReceiptSend' :disabled='isReceiptSend'>票据测试</button>\r\n\t\t\t   <button type='primary' @tap='getList' :loading='isLabelSend' :disabled='isLabelSend'>获取订单数据</button>\r\n\t\t\t</view>\r\n\t\t\r\n\t\t\t<view style='margin-top:4%;display: flex;flex-direction: row;'>\n\t\t\t\t<!-- hidden='true' -->\r\n\t\t\t\t<canvas  canvas-id='edit_area_canvas' :style=\"{width:canvasWidth+'px',height:canvasHeight+'px'}\"></canvas>\r\n\t\t\t</view>\r\n\t\t\r\n\t\t    <picker style='margin:20px' mode='selector' :range='buffSize' :value='buffIndex' @change='buffBindChange'>\r\n\t\t\t\t当前每次发送字节数为(点击可更换)：{{buffSize[buffIndex]}}\r\n\t\t\t</picker>\r\n\t\t\r\n\t\t\t<picker style='margin:20px' mode='selector' :range='printNum' :value='printNumIndex' @change='printNumBindChange'>\r\n\t\t\t\t当前打印份数(点击可更换)：{{printNum[printNumIndex]}}\r\n\t\t\t</picker>\r\n\t\t\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\tvar tsc = require(\"../../util/ble/tsc.js\");\r\n\tvar esc = require(\"../../util/ble/esc.js\");\r\n\tvar encode = require(\"../../util/ble/encoding.js\");\r\n\timport {\r\n\t\tmapState\r\n\t} from 'vuex';\r\n\texport default {\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tsendContent: \"\",\r\n\t\t\t\tlooptime: 0,\r\n\t\t\t\tcurrentTime: 1,\r\n\t\t\t\tlastData: 0,\r\n\t\t\t\toneTimeData: 0,\r\n\t\t\t\treturnResult: \"\",\r\n\t\t\t\tcanvasWidth: 180,\r\n\t\t\t\tcanvasHeight: 180,\r\n\t\t\t\timageSrc: '../../static/img/abc_ic_star_black_16dp.png',\r\n\t\t\t\tbuffSize: [],\r\n\t\t\t\tbuffIndex: 0,\r\n\t\t\t\tprintNum: [],\r\n\t\t\t\tprintNumIndex: 0,\r\n\t\t\t\tprinterNum: 1,\r\n\t\t\t\tcurrentPrint: 1,\r\n\t\t\t\tisReceiptSend: false,\r\n\t\t\t\tisLabelSend: false,\r\n\t\t\t\tlist:[]\r\n\t\t\t};\r\n\t\t},\r\n\t\tcomputed: mapState(['sysinfo', 'Bluetooth']),\r\n\t\tonLoad() {\r\n\t\t\tlet that = this;\r\n\t\t\tlet {\r\n\t\t\t\tBLEInformation\r\n\t\t\t} = that.Bluetooth;\r\n\t\t\t// uni.notifyBLECharacteristicValueChange({\r\n\t\t\t//   deviceId: BLEInformation.deviceId,\r\n\t\t\t//   serviceId: BLEInformation.notifyServiceId,\r\n\t\t\t//   characteristicId: BLEInformation.notifyCharaterId,\r\n\t\t\t//   state: true,\r\n\t\t\t//   success(res) {\r\n\t\t\t// \tuni.onBLECharacteristicValueChange(function(r) {\r\n\t\t\t// \t  console.log(`characteristic ${r.characteristicId} has changed, now is ${r}`)\r\n\t\t\t// \t})\r\n\t\t\t//   },\r\n\t\t\t//   fail: function(e) {\r\n\t\t\t// \tconsole.log(e)\r\n\t\t\t//   },\r\n\t\t\t//   complete: function(e) {\r\n\t\t\t// \tconsole.log(e)\r\n\t\t\t//   }\r\n\t\t\t// })\r\n\t\t},\r\n\t\tonReady(){\r\n\t\t\tlet list = []\r\n\t\t\tlet numList = []\r\n\t\t\tlet j = 0\r\n\t\t\tfor (let i = 20; i < 200; i += 10) {\r\n\t\t\t  list[j] = i;\r\n\t\t\t  j++\r\n\t\t\t}\r\n\t\t\tfor (let i = 1; i < 10; i++) {\r\n\t\t\t  numList[i - 1] = i\r\n\t\t\t}\r\n\t\t\tthis.buffSize = list;\r\n\t\t\tthis.oneTimeData = list[0];\r\n\t\t\tthis.printNum = numList;\r\n\t\t\tthis.printerNum = numList[0];\r\n\t\t},\r\n\t\tonShow(){\r\n\t\t\tlet that = this;\r\n\t\t\tlet width;\r\n\t\t\tlet height;\r\n\t\t\tuni.getImageInfo({\r\n\t\t\t  src: that.imageSrc,\r\n\t\t\t  success(res) {\r\n\t\t\t\tconsole.log(res.width)\r\n\t\t\t\tconsole.log(res.height)\r\n\t\t\t\twidth = res.width\r\n\t\t\t\theight = res.height\r\n\t\t\t\tthat.canvasWidth = res.width;\r\n\t\t\t\tthat.canvasHeight = res.height;\r\n\t\t\t  }\r\n\t\t\t})\r\n\t\t\tconst ctx = uni.createCanvasContext(\"edit_area_canvas\", this);\r\n\t\t\t// if (app.globalData.platform == \"android\") {\r\n\t\t\t//   ctx.translate(width, height)\r\n\t\t\t//   ctx.rotate(180 * Math.PI / 180)\r\n\t\t\t// }\r\n\t\t\tctx.drawImage(this.imageSrc, 0, 0, width, height);\r\n\t\t\tctx.draw();\r\n\t\t},\r\n\t\tonUnload() {\r\n\t\t\tlet that = this;\r\n\t\t\tlet {\r\n\t\t\t\tBLEInformation\r\n\t\t\t} = that.Bluetooth;\r\n\t\t\t// uni.closeBLEConnection({\r\n\t\t //      deviceId: BLEInformation.deviceId,\r\n\t\t //      success: function(res) {\r\n\t\t //        console.log(\"关闭蓝牙成功\")\r\n\t\t //      },\r\n\t\t //    })\t\r\n\t\t},\r\n\t\tmethods:{\r\n\t\t\tgetList(){\r\n\t\t\t\tthis.$u.get('/api/shop_order/print').then(res=>{\r\n\t\t\t\t\tconsole.log(res)\r\n\t\t\t\t\tthis.list = res.data\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\t//获取输入内容\r\n\t\t\tinputEvent(e){\r\n\t\t\t\tthis.sendContent = e.detail.value;\r\n\t\t\t},\r\n\t\t\t//输入框点击发送\r\n\t\t\tsendData(){\r\n\t\t\t\tlet data = this.sendContent + \"\\n\"\r\n\t\t\t\tthis.looptime = 0;\r\n\t\t\t\tvar content = new encode.TextEncoder(\r\n\t\t\t\t  'gb18030', {\r\n\t\t\t\t\tNONSTANDARD_allowLegacyEncoding: true\r\n\t\t\t\t  }).encode(data);\r\n\t\t\t\r\n\t\t\t\tthis.prepareSend(content);\r\n\t\t\t},\r\n\t\t\t//标签测试\r\n\t\t\tlabelTest(){\r\n\t\t\t\tlet that = this;\r\n\t\t\t\tlet canvasWidth = that.canvasWidth\r\n\t\t\t\tlet canvasHeight = that.canvasHeight\r\n\t\t\t\tlet command = tsc.jpPrinter.createNew()\r\n\t\t\t\tcommand.setSize(48, 40)\r\n\t\t\t\tcommand.setGap(0)\r\n\t\t\t\tcommand.setCls()\r\n\t\t\t\tcommand.setText(0, 30, \"TSS24.BF2\", 1, 1, \"图片\")\r\n\t\t\t\tcommand.setQR(40, 120, \"L\", 5, \"A\", \"www.smarnet.cc佳博智汇\")\r\n\t\t\t\tcommand.setText(60, 90, \"TSS24.BF2\", 1, 1, \"佳博智汇\")\r\n\t\t\t\tcommand.setText(170, 50, \"TSS24.BF2\", 1, 1, \"小程序测试\")\r\n\t\t\t\tcommand.setText(170, 90, \"TSS24.BF2\", 1, 1, \"测试数字12345678\")\r\n\t\t\t\tcommand.setText(170, 120, \"TSS24.BF2\", 1, 1, \"测试英文abcdefg\")\r\n\t\t\t\tcommand.setText(170, 150, \"TSS24.BF2\", 1, 1, \"测试符号/*-+!@#$\")\r\n\t\t\t\tcommand.setBarCode(170, 180, \"EAN8\", 64, 1, 3, 3, \"1234567\")\r\n\t\t\t\tuni.canvasGetImageData({\r\n\t\t\t\t  canvasId: 'edit_area_canvas',\r\n\t\t\t\t  x: 0,\r\n\t\t\t\t  y: 0,\r\n\t\t\t\t  width: canvasWidth,\r\n\t\t\t\t  height: canvasHeight,\r\n\t\t\t\t  success: function(res) {\r\n\t\t\t\t\tcommand.setBitmap(60, 0, 1, res)\r\n\t\t\t\t  },\r\n\t\t\t\t  complete: function() {\r\n\t\t\t\t\tcommand.setPagePrint()\r\n\t\t\t\t\tthat.isLabelSend = true;\r\n\t\t\t\t\tthat.prepareSend(command.getData())\r\n\t\t\t\t  }\r\n\t\t\t\t})\r\n\t\t\t},\r\n\r\n\t\t\t//票据测试\r\n\t\t\treceiptTest(){\r\n\t\t\t\tvar that = this;\r\n\t\t\t\tvar canvasWidth = that.canvasWidth\r\n\t\t\t\tvar canvasHeight = that.canvasHeight\r\n\t\t\t\t\tvar command = esc.jpPrinter.createNew()\r\n\t\t\t\t\tvar item = this.list\r\n\t\t\t\t\tcommand.init()\r\n\t\t\t\t\t// 标题\r\n\t\t\t\t\tcommand.bold(1);//加粗\r\n\t\t\t\t\tcommand.setFontSize(10);//字体大小\r\n\t\t\t\t\tcommand.setSelectJustification(1)//居中\r\n\t\t\t\t\tcommand.rowSpace(100);\r\n\t\t\t\t\tcommand.setText(item.shop[0].name+' '+item.shop[0].campus_name);\r\n\t\t\t\t\tcommand.setPrint();\r\n\t\t\t\t\tcommand.rowSpace(60);\r\n\t\t\t\t\t\r\n\t\t\t\t\tcommand.bold(0);//取消加粗\r\n\t\t\t\t\tcommand.setFontSize(0);//正常字体\r\n\t\t\t\t\t//时间\r\n\t\t\t\t\tcommand.setSelectJustification(0);//居左\r\n\t\t\t\t\tcommand.setText(\"时间：\"+item.pay_time_text);\r\n\t\t\t\t\tcommand.setPrint();\r\n\t\t\t\t\t//编号\r\n\t\t\t\t\tcommand.setSelectJustification(0);//居左\r\n\t\t\t\t\tcommand.setText(\"订单号：\"+item.order_number);\r\n\t\t\t\t\tcommand.setPrintAndFeed(80);//打印并走纸feed个单位\r\n\t\t\t\t\t//列表\r\n\t\t\t\t\tcommand.rowSpace(80);//间距\r\n\t\t\t\t\tcommand.bold(5);//加粗\r\n\t\t\t\t\tcommand.setText(\"商品名\");\r\n\t\t\t\t\tcommand.setAbsolutePrintPosition(100);\r\n\t\t\t\t\tcommand.setText(\"规格\");\r\n\t\t\t\t\tcommand.setAbsolutePrintPosition(180);\r\n\t\t\t\t\tcommand.setText(\"数量\");\r\n\t\t\t\t\tcommand.setAbsolutePrintPosition(270);\r\n\t\t\t\t\tcommand.setText(\"单价\");\r\n\t\t\t\t\tcommand.setPrint()\r\n\t\t\t\t\tcommand.bold(0);//加粗\r\n\t\t\t\t\titem.goods.forEach(item1=>{\r\n\t\t\t\t\t\t// -------1\r\n\t\t\t\t\t\tcommand.setText(item1.goods_name);\r\n\t\t\t\t\t\tcommand.setAbsolutePrintPosition(100);\r\n\t\t\t\t\t\tcommand.setText(item1.goods_spec_name);\r\n\t\t\t\t\t\tcommand.setAbsolutePrintPosition(180);\r\n\t\t\t\t\t\tcommand.setText(item1.total_num);\r\n\t\t\t\t\t\tcommand.setAbsolutePrintPosition(270);\r\n\t\t\t\t\t\tcommand.setText(item1.goods_price);\r\n\t\t\t\t\t\tcommand.setPrint()\r\n\t\t\t\t\t})\r\n\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t//合计\r\n\t\t\t\t\tcommand.bold(5);//加粗\r\n\t\t\t\t\tcommand.setText(\"总数：\"+item.goods_num);\r\n\t\t\t\t\tcommand.setAbsolutePrintPosition(375);\r\n\t\t\t\t\tcommand.setText(\"合计：\"+item.pay_price);\r\n\t\t\t\t\tcommand.setPrint();\r\n\t\t\t\t\t// // 收银员\r\n\t\t\t\t\t// command.rowSpace(120);//间距\r\n\t\t\t\t\t// command.setAbsolutePrintPosition(120);\r\n\t\t\t\t\t// command.setText(\"店员：何丹\");\r\n\t\t\t\t\t// command.setAbsolutePrintPosition(320);\r\n\t\t\t\t\t// command.setText(\"会员：1000000000\");\r\n\t\t\t\t\t// command.setPrint()\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t//收货地址\r\n\t\t\t\t\tcommand.rowSpace(80);//间距\r\n\t\t\t\t\tcommand.bold(2);//加粗\r\n\t\t\t\t\tcommand.setSelectJustification(1);//居中\r\n\t\t\t\t\tcommand.setText(item.user_address[0].name+' '+item.user_address[0].phone);\r\n\t\t\t\t\tcommand.setPrint();\r\n\t\t\t\t\tcommand.setText(item.user_address[0].campus_name+' '+item.user_address[0].address);\r\n\t\t\t\t\tcommand.setPrint();\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t//备注，约定时间\r\n\t\t\t\t\tcommand.setSelectJustification(0);//居左\r\n\t\t\t\t\tcommand.setText(\"约定送达时间:\"+item.user_delivery_time);\r\n\t\t\t\t\tcommand.setPrint();\r\n\t\t\t\t\tcommand.setText(\"客户备注:\"+item.buyer_remark);\r\n\t\t\t\t\tcommand.setPrint();\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\tcommand.setPrintAndFeedRow(3);\r\n\t\t\t\t\t\r\n\t\t\t\t\tthat.isReceiptSend = true;\r\n\t\t\t\t\tthat.prepareSend(command.getData());\r\n\t\t\t\t\t\r\n\t\t\t\t\t\r\n\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t//准备发送，根据每次发送字节数来处理分包数量\r\n\t\t\tprepareSend(buff){\r\n\t\t\t\tconsole.log(buff);\r\n\t\t\t\tlet that = this\r\n\t\t\t\tlet time = that.oneTimeData\r\n\t\t\t\tlet looptime = parseInt(buff.length / time);\r\n\t\t\t\tlet lastData = parseInt(buff.length % time);\r\n\t\t\t\tconsole.log(looptime + \"---\" + lastData)\r\n\t\t\t\tthis.looptime = looptime + 1;\r\n\t\t\t\tthis.lastData = lastData;\r\n\t\t\t\tthis.currentTime = 1;\r\n\t\t\t\tthat.Send(buff)\r\n\t\t\t},\r\n\t\t\t//查询打印机状态\r\n\t\t\tqueryStatus(){\r\n\t\t\t\tlet command = esc.jpPrinter.Query();\r\n\t\t\t\tcommand.getRealtimeStatusTransmission(1);\r\n\t\t\t},\r\n\t\t\t//分包发送\r\n\t\t\tSend(buff){\r\n\t\t\t\tlet that = this\r\n\t\t\t\tlet {currentTime,looptime:loopTime,lastData,oneTimeData:onTimeData,printerNum:printNum,currentPrint}=that;\r\n\t\t\t\tlet buf;\r\n\t\t\t\tlet dataView;\r\n\t\t\t\tif (currentTime < loopTime) {\r\n\t\t\t\t  buf = new ArrayBuffer(onTimeData)\r\n\t\t\t\t  dataView = new DataView(buf)\r\n\t\t\t\t  for (var i = 0; i < onTimeData; ++i) {\r\n\t\t\t\t\tdataView.setUint8(i, buff[(currentTime - 1) * onTimeData + i])\r\n\t\t\t\t  }\r\n\t\t\t\t} else {\r\n\t\t\t\t  buf = new ArrayBuffer(lastData)\r\n\t\t\t\t  dataView = new DataView(buf)\r\n\t\t\t\t  for (var i = 0; i < lastData; ++i) {\r\n\t\t\t\t\tdataView.setUint8(i, buff[(currentTime - 1) * onTimeData + i])\r\n\t\t\t\t  }\r\n\t\t\t\t}\r\n\t\t\t\tconsole.log(\"第\" + currentTime + \"次发送数据大小为：\" + buf.byteLength)\r\n\t\t\t\tlet {\r\n\t\t\t\t\tBLEInformation\r\n\t\t\t\t} = that.Bluetooth;\r\n\t\t\t\t\r\n\t\t\t\tplus.bluetooth.writeBLECharacteristicValue({\r\n\t\t\t\t  deviceId: BLEInformation.deviceId,\r\n\t\t\t\t  serviceId: BLEInformation.writeServiceId,\r\n\t\t\t\t  characteristicId: BLEInformation.writeCharaterId,\r\n\t\t\t\t  value: buf,\r\n\t\t\t\t  success: function(res) {\r\n\t\t\t\t\tconsole.log(res)\r\n\t\t\t\t\tthis.$u.get('/api/shop_order/printNotify',{\r\n\t\t\t\t\t\torder_id:this.list.id\r\n\t\t\t\t\t}).then(res=>{\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle:'新订单打印成功',\r\n\t\t\t\t\t\t\ticon:'success'\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t})\r\n\t\t\t\t  },\r\n\t\t\t\t  fail: function(e) {\r\n\t\t\t\t\tconsole.log(e)\r\n\t\t\t\t  },\r\n\t\t\t\t  complete: function() {\r\n\t\t\t\t\tcurrentTime++\r\n\t\t\t\t\tif (currentTime <= loopTime) {\r\n\t\t\t\t\t  that.currentTime = currentTime;\r\n\t\t\t\t\t  that.Send(buff)\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t  uni.showToast({\r\n\t\t\t\t\t\ttitle: '已打印第' + currentPrint + '张',\r\n\t\t\t\t\t  })\r\n\t\t\t\t\t  if (currentPrint == printNum) {\r\n\t\t\t\t\t\tthat.looptime = 0;\r\n\t\t\t\t\t\tthat.lastData = 0;\r\n\t\t\t\t\t\tthat.currentTime = 1;\r\n\t\t\t\t\t\tthat.isReceiptSend = false;\r\n\t\t\t\t\t\tthat.isLabelSend = false;\r\n\t\t\t\t\t\tthat.currentPrint = 1;\r\n\t\t\t\t\t  } else {\r\n\t\t\t\t\t\tcurrentPrint++;\r\n\t\t\t\t\t\tthat.currentPrint = currentPrint;\r\n\t\t\t\t\t\tthat.currentTime = 1;\r\n\t\t\t\t\t\tthat.Send(buff)\r\n\t\t\t\t\t  }\r\n\t\t\t\t\t}\r\n\t\t\t\t  }\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tbuffBindChange: function(res) { //更改打印字节数\r\n\t\t\t    let index = res.detail.value\r\n\t\t\t    let time = this.buffSize[index]\r\n\t\t\t    this.buffIndex = index;\r\n\t\t\t    this.oneTimeData = time;\r\n\t\t\t},\r\n\t\t\tprintNumBindChange: function(res) { //更改打印份数\r\n\t\t\t    let index = res.detail.value\r\n\t\t\t    let num = this.printNum[index]\r\n\t\t\t    this.printNumIndex = index;\r\n\t\t\t    this.printerNum = num;\r\n\t\t\t},\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style lang=\"less\">\r\n\t.input{  \r\n\t\ttext-align: top; \r\n\t\t width: 90%;  \r\n\t\t height: 150px;  \r\n\t\t margin-left: 4%; \r\n\t\t margin-right: 4%;  \r\n\t\t margin-top: 10px; \r\n\t\t margin-bottom: 12px; \r\n\t\tborder: 1px solid slategray;\r\n\t}\r\n\t.receiver_info_scroll_view{ \r\n\t\twidth: 90%; \r\n\t\theight: 200px; \r\n\t\tmargin-left: 4%;\r\n\t\tmargin-right: 4%; \r\n\t\tmargin-top: 10px;\r\n\t\tmargin-bottom: 25px;\r\n\t\tborder: 1px solid black;\r\n\t}\r\n\t.result{ \r\n\t\twidth: 90%;  \r\n\t\theight: 150px; \r\n\t\tborder: 1px solid black; \r\n\t\tmargin-left: 4%;\r\n\t\tmargin-bottom: 4%; \r\n\t\tmargin-top: 5%;\r\n\t}\r\n    button{ \r\n\t  width: 90%; \r\n\t  margin-left: 5%; \r\n\t  margin-right: 5%;\r\n\t}\r\n\t.switch{ \r\n\t\tfloat: right; \r\n\t\tmargin-right: 20px; \r\n\t\tmargin-bottom: 16px;\r\n\t}\r\n    text{ \r\n\t   color: #fff; \r\n\t   display: block;\r\n\t}\r\n\tinput{  \r\n\t\tcolor: gainsboro;  \r\n\t\tfloat: left;\r\n\t}\r\n\t.v_net_ssid{  \r\n\t\twidth: 100%; \r\n\t\tbackground:  #fff;\r\n\t}\r\n\t.v_net_passw{ \r\n\t\twidth: 100%; \r\n\t\tbackground: antiquewhite;\r\n\t}\r\n    .swiper{ \r\n\t   width: 100%; \r\n\t   height: 100%;\r\n\t}\r\n\r\n</style>\n","import mod from \"-!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--10-oneOf-1-0!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--10-oneOf-1-1!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--10-oneOf-1-2!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--10-oneOf-1-3!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\less-loader\\\\dist\\\\cjs.js??ref--10-oneOf-1-4!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--10-oneOf-1-5!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./sendCommand.vue?vue&type=style&index=0&lang=less&\"; export default mod; export * from \"-!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--10-oneOf-1-0!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--10-oneOf-1-1!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--10-oneOf-1-2!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--10-oneOf-1-3!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\less-loader\\\\dist\\\\cjs.js??ref--10-oneOf-1-4!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--10-oneOf-1-5!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./sendCommand.vue?vue&type=style&index=0&lang=less&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1602834296264\n      var cssReload = require(\"D:/Program Files/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}